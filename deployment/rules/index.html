<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.71.1"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/coreruleset-documentation/images/favicon.png type=image/png><title>Rules :: Core Rule Set Documentation</title><link href=/coreruleset-documentation/css/nucleus.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/fontawesome-all.min.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/hybrid.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/featherlight.min.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/perfect-scrollbar.min.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/auto-complete.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/atom-one-dark-reasonable.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/theme.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/hugo-theme.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/theme-blue.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/foo.css?1592189088 rel=stylesheet><link href=/coreruleset-documentation/css/bar.css?1592189088 rel=stylesheet><script src=/coreruleset-documentation/js/jquery-3.3.1.min.js?1592189088></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/coreruleset-documentation/deployment/rules/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://fzipi.github.io/coreruleset-documentation/><img src=https://fzipi.github.io/coreruleset-documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/coreruleset-documentation/js/lunr.min.js?1592189088></script><script type=text/javascript src=/coreruleset-documentation/js/auto-complete.js?1592189088></script><script type=text/javascript>var baseurl="https:\/\/fzipi.github.io\/coreruleset-documentation\/";</script><script type=text/javascript src=/coreruleset-documentation/js/search.js?1592189088></script></div><div class=highlightable><ul class=topics><li data-nav-id=/coreruleset-documentation/deployment/ title="OWASP CRS Quickstart" class="dd-item
parent"><a href=/coreruleset-documentation/deployment/>Deployment</a><ul><li data-nav-id=/coreruleset-documentation/deployment/install/ title="Installing CoreRuleSet" class=dd-item><a href=/coreruleset-documentation/deployment/install/><b>1. </b>Install</a></li><li data-nav-id=/coreruleset-documentation/deployment/configuration/ title=Configuration class=dd-item><a href=/coreruleset-documentation/deployment/configuration/><b>2. </b>Configuration</a></li><li data-nav-id=/coreruleset-documentation/deployment/rules/ title=Rules class="dd-item active"><a href=/coreruleset-documentation/deployment/rules/><b>3. </b>Rules</a></li><li data-nav-id=/coreruleset-documentation/deployment/exceptions/ title="Adding Exceptions and Tuning CRS" class=dd-item><a href=/coreruleset-documentation/deployment/exceptions/><b>4. </b>Exceptions</a></li><li data-nav-id=/coreruleset-documentation/deployment/testing/ title="Testing the Rule Set" class=dd-item><a href=/coreruleset-documentation/deployment/testing/><b>5. </b>Testing</a></li><li data-nav-id=/coreruleset-documentation/deployment/anomaly/ title="Anomaly Scoring Mode" class=dd-item><a href=/coreruleset-documentation/deployment/anomaly/><b>6. </b>Anomaly</a></li><li data-nav-id=/coreruleset-documentation/deployment/support/ title="Still need help?" class=dd-item><a href=/coreruleset-documentation/deployment/support/><b>8. </b>Support</a></li><li data-nav-id=/coreruleset-documentation/deployment/making/ title=Making class=dd-item><a href=/coreruleset-documentation/deployment/making/><b>9. </b>Making</a></li><li data-nav-id=/coreruleset-documentation/deployment/metadata/ title=Metadata class=dd-item><a href=/coreruleset-documentation/deployment/metadata/><b>10. </b>Metadata</a></li></ul></li><li data-nav-id=/coreruleset-documentation/development/ title=Developments class=dd-item><a href=/coreruleset-documentation/development/>Developments</a><ul><li data-nav-id=/coreruleset-documentation/development/ruleid/ title="Rule IDs" class=dd-item><a href=/coreruleset-documentation/development/ruleid/><b>1. </b>Rule IDs</a></li></ul></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/fzipi/coreruleset-documentation/blob/master/content/deployment/rules.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links>Rules</span></div><div class=progress><div class=wrapper><nav id=TableOfContents></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Rules</h1><h1 id=whats-in-the-rules>What&rsquo;s In The Rules</h1><p>| <strong>REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example</strong>
| Â Configuration Path:
<code>rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example</code>
| This file is used to add LOCAL exceptions for your site. Often in this
file we would see rules that short-circuit inspection and allow
certain transactions to skip through inspection.
| <code>Example: SecRule REMOTE_ADDR "@ipMatch 192.168.1.100" "phase:1,id:'981033',t:none,nolog,pass,ctl:ruleEngine=Off"</code></p><p><strong>REQUEST-901-INITIALIZATION.conf</strong>
TODO</p><p><strong>REQUEST-903.9001-DRUPAL-EXCLUSION-RULES.conf
REQUEST-903.9002-WORDPRESS-EXCLUSION-RULES.conf
REQUEST-903.9003-NEXTCLOUD-EXCLUSION-RULES.conf
REQUEST-903.9004-DOKUWIKI-EXCLUSION-RULES.conf
REQUEST-903.9005-CPANEL-EXCLUSION-RULES.conf
REQUEST-903.9006-XENFORO-EXCLUSION-RULES.conf</strong>
TODO</p><p>| <strong>REQUEST-905-COMMON-EXCEPTIONS</strong>
| Configuration Path:
<code>rules/REQUEST-905-COMMON-EXCEPTIONS.conf</code>
|
| Some rules are quite prone to causing false positives in well
established software, such as Apache callbacks or Google Analytics
tracking cookie. This file offers rules that will allow the
transactions to avoid triggering these false positives.</p><p>| <strong>REQUEST-910-IP-REPUTATION</strong>
| Configuration Path:
<code>rules/REQUEST-910-IP-REPUTATION.conf</code>
|
| These rules deal with detecting traffic from IPs that have previously
been involved with malicious activity, either on our local site or
globally.</p><p><strong>REQUEST-911-METHOD-ENFORCEMENT</strong>
TODO</p><p>| <strong>REQUEST-912-DOS-PROTECTION</strong>
| Configuration Path:
<code>rules/REQUEST-912-DOS-PROTECTION.conf</code>
|
| The rules in this file will attempt to detect some level 7 DoS (Denial
of Service) attacks against your server.</p><p>| <strong>REQUEST-913-SCANNER-DETECTION</strong>
| Configuration Path:
<code>rules/REQUEST-913-SCANNER-DETECTION.conf</code>
|
| These rules are concentrated around detecting security tools and
scanners.</p><p>| <strong>REQUEST-920-PROTOCOL-ENFORCEMENT</strong>
| Configuration Path:
<code>rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf</code>
|
| The rules in this file center around detecting requests that either
violate HTTP or represent a request that no modern browser would
generate, for instance missing a user-agent.</p><p>| <strong>REQUEST-921-PROTOCOL-ATTACK</strong>
|
| Configuration Path: <code>rules/REQUEST-21-PROTOCOL-ATTACK.conf</code>
| The rules in this file focus on specific attacks against the HTTP
protocol itself such as HTTP Request Smuggling and Response Splitting.</p><p>| <strong>REQUEST-930-APPLICATION-ATTACK-LFI</strong>
|
| Configuration Path: <code>rules/REQUEST-930-APPLICATION-ATTACK-LFI.conf</code></p><p>| These rules attempt to detect when a user is trying to include a file
that would be local to the webserver that they should not have access
to. Exploiting this type of attack can lead to the web application or
server being compromised.</p><p>| <strong>REQUEST-931-APPLICATION-ATTACK-RFI</strong>
| Configuration Path: <code>rules/REQUEST-31-APPLICATION-ATTACK-RFI.conf</code>
|
| These rules attempt to detect when a user is trying to include a
remote resource into the web application that will be executed.
Exploiting this type of attack can lead to the web application or
server being compromised.</p><p><strong>REQUEST-932-APPLICATION-ATTACK-RCE.conf
REQUEST-933-APPLICATION-ATTACK-PHP.conf
REQUEST-934-APPLICATION-ATTACK-NODEJS.conf</strong></p><p>TODO</p><p><strong>REQUEST-941-APPLICATION-ATTACK-XSS.conf</strong>
TODO</p><p>| <strong>REQUEST-942-APPLICATION-ATTACK-SQLI</strong>
| Configuration Path: <code>rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf</code>
|
| Within this configuration file we provide rules that protect against
SQL injection attacks. SQLi attackers occur when an attacker passes
crafted control characters to parameters to an area of the application
that is expecting only data. The application will then pass the
control characters to the database. This will end up changing the
meaning of the expected SQL query.</p><p>| <strong>REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION</strong>
| Configuration Path: <code>rules/REQUEST-43-APPLICATION-ATTACK-SESSION-FIXATION.conf</code>
|
| These rules focus around providing protection against Session Fixation
attacks.</p><p><strong>REQUEST-944-APPLICATION-ATTACK-JAVA</strong>
TODO</p><p>| <strong>REQUEST-949-BLOCKING-EVALUATION</strong>
| Configuration Path: <code>rules/REQUEST-49-BLOCKING-EVALUATION.conf</code>
|
| These rules provide the anomaly based blocking for a given request. If
you are in anomaly detection mode this file must not be deleted.</p><p>| <strong>RESPONSE-954-DATA-LEAKAGES-IIS</strong>
| Configuration Path:
<code>rules/RESPONSE-954-DATA-LEAKAGES-IIS.conf</code>
|
| These rules provide protection against data leakages that may occur
because of Microsoft IIS</p><p>| <strong>RESPONSE-952-DATA-LEAKAGES-JAVA</strong>
| Configuration Path: <code>rules/RESPONSE-952-DATA-LEAKAGES-JAVA.conf</code>
|
| These rules provide protection against data leakages that may occur
because of Java</p><p>| <strong>RESPONSE-953-DATA-LEAKAGES-PHP</strong>
| Configuration Path:
<code>rules/RESPONSE-953-DATA-LEAKAGES-PHP.conf</code>
|
| These rules provide protection against data leakages that may occur
because of PHP</p><p>| <strong>RESPONSE-950-DATA-LEAKAGES</strong>
| Configuration Path:
<code>rules/RESPONSE-950-DATA-LEAKAGES.conf</code>
|
| These rules provide protection against data leakages that may occur
genericly</p><p>| <strong>RESPONSE-951-DATA-LEAKAGES-SQL</strong>
| Configuration Path:
<code>rules/RESPONSE-951-DATA-LEAKAGES-SQL.conf</code>
|
| These rules provide protection against data leakages that may occur
from backend SQL servers. Often these are indicative of SQL injection
issues being present.</p><p>| <strong>RESPONSE-959-BLOCKING-EVALUATION</strong>
| Configuration Path: <code>rules/RESPONSE-959-BLOCKING-EVALUATION.conf</code>
|
| These rules provide the anomaly based blocking for a given response.
If you are in anomaly detection mode this file must not be deleted.</p><p>| <strong>RESPONSE-980-CORRELATION</strong>
| Configuration Path: <code>rules/RESPONSE-980-CORRELATION.conf</code>
|
| The rules in this configuration file facilitate the gathering of data
about successful and unsuccessful attacks on the server.</p><p><strong>REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example</strong>
Configuration Path: <code>rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example</code></p><p>This file is used to add LOCAL exceptions for your site. Often in this
file we would see rules that short-circuit inspection and allow
certain transactions to skip through inspection.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/coreruleset-documentation/deployment/configuration/ title=Configuration><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/coreruleset-documentation/deployment/exceptions/ title="Adding Exceptions and Tuning CRS" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/coreruleset-documentation/js/clipboard.min.js?1592189088></script><script src=/coreruleset-documentation/js/perfect-scrollbar.min.js?1592189088></script><script src=/coreruleset-documentation/js/perfect-scrollbar.jquery.min.js?1592189088></script><script src=/coreruleset-documentation/js/jquery.sticky.js?1592189088></script><script src=/coreruleset-documentation/js/featherlight.min.js?1592189088></script><script src=/coreruleset-documentation/js/highlight.pack.js?1592189088></script><script>hljs.initHighlightingOnLoad();</script><script src=/coreruleset-documentation/js/modernizr.custom-3.6.0.js?1592189088></script><script src=/coreruleset-documentation/js/learn.js?1592189088></script><script src=/coreruleset-documentation/js/hugo-learn.js?1592189088></script><link href=/coreruleset-documentation/mermaid/mermaid.css?1592189088 rel=stylesheet><script src=/coreruleset-documentation/mermaid/mermaid.js?1592189088></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>